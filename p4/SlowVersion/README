This is a slow version of P4.

Author: Siyuan Yao
